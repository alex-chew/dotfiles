#!/usr/bin/env bash
source $(dirname $0)/_colors

info=$(nmcli -f "GENERAL.STATE,GENERAL.CONNECTION" dev show wlan0)

if [[ $(echo $info | awk '{ print $3 }') != '(connected)' ]]; then
  # full text
  echo "-- "
  # short text
  echo
  #color
  echo ${base03}

else
  ssid=$(echo $info | awk '{ print $5 }')
  qual=$(grep wlan0 /proc/net/wireless | awk '{ print int($3 * 100 / 70) }')

  # full text
  echo "$ssid ($qual%) "

  # short text
  echo

  # color
  if (( "$qual" > 70 )); then
    echo ${base07}
  elif (( "$qual" > 40 )); then
    echo ${base0A}
  elif (( "$qual" > 20 )); then
    echo ${base09}
  else
    echo ${base08}
  fi

fi

